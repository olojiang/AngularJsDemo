<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <link rel="stylesheet" href="css/vendor/bootstrap.css" />
    <link rel="stylesheet" href="css/vendor/datetimepicker.css" />

    <script src="js/vendor/jquery-1.11.2.js"></script>
    <script src="js/vendor/moment.min.js"></script>
    <script src="js/vendor/bootstrap.js"></script>
    <script src="js/vendor/angular.js"></script>
    <script src="js/vendor/datetimepicker.js"></script>

    <script type="text/javascript">
		// Need to include this first.
        var module = angular.module("myApp", ['ui.bootstrap.datetimepicker']);
        module.controller('myController', function($scope){
            $scope.onTimeSet = function(newDate, oldDate) {
                console.info("newDate: ", newDate, " oldDate: ", oldDate);
            };

            $scope.beforeRender = function($view, $dates, $leftDate, $update, $rightDate) {
                console.info("$view: ", $view, " $dates: ", $dates, " $leftDate: ", $leftDate, " $update: ", $update, " $rightDate: ", $rightDate);
                var index = Math.floor(Math.random() * $dates.length);
                $dates[index].selectable = false;

                if($view == 'day') {
//                    $leftDate['selectable'] = false;
                }

                // Can not select old date.
                for(var i in $dates) {
                    var day = $dates[i];
                    if( day.dateValue < moment.utc(new Date()).add(+8, 'hours') ) { // +8 map to our timezone, otherwise, it's not right.
                        day['selectable'] = false;
                    } else if(i>0) {
                        $dates[i-1]['selectable'] = true;
                    }
                }
            };
        });
    </script>
</head>
<body>

<!-- https://github.com/dalelotts/angular-bootstrap-datetimepicker -->
<!-- http://dalelotts.github.io/angular-bootstrap-datetimepicker/ -->
<div ng-app="myApp" ng-controller="myController">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <datetimepicker ng-model="dateX"></datetimepicker>
                <span>{{dateX | date: 'yyyy-MM-hh HH:mm:ss'}}</span>
            </div>
            <div class="col-md-4">
                <form name="myForm" novalidate>
                    <div class="dropdown">
                        <a class="dropdown-toggle my-toggle-select" id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="">
                            <div class="input-append">
                                <input type="input-append" class="form-control" value="{{dateY|date: 'yyyy-MM-dd HH:mm:ss'}}" readonly />
                                <span class="add-on"><i class="glyphicon glyphicon-calendar form-control-feedback"></i></span>
                            </div>
                        </a>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                            <datetimepicker data-ng-model="dateY"
                                            data-datetimepicker-config="{startView: 'month', minView: 'minute', minuteStep: 10, dropdownSelector: '.my-toggle-select'}"
                                            data-before-render="beforeRender($view, $dates, $leftDate, $upDate, $rightDate)"
                                    data-on-set-time="onTimeSet(newDate, oldDate)"
                                    name="myCal"
                                    required></datetimepicker>
                        </ul>
                    </div>
                    <p>$invalid: {{myForm.myCal.$invalid}}</p>
                    <p>$error: {{myForm.myCal.$error}}</p>
                    <p>$dirty: {{myForm.myCal.$dirty}}</p>
                </form>
            </div>
            <div class="col-md-4">
                <div class="dropdown">
                    <a class="dropdown-toggle my-toggle-select2" id="eLabel" role="button" data-toggle="dropdown" data-target="#" href="">
                        <div class="input-append"><input type="text-large" class="form-control" data-ng-model="data.date"><span class="add-on"><i
                                class="glyphicon glyphicon-calendar form-control-feedback"></i></span>
                        </div>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="eLabel">
                        <datetimepicker data-ng-model="data.date"
                                        data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select2' }"></datetimepicker>
                    </ul>
                </div>
            </div>
			
			<div class="col-md-4">
			<div class="form-group">
                    <label for="grade">乘车日期（开始）</label>
                    <div class="dropdown">
                        <a class="dropdown-toggle" id="busStartDate" role="button" data-toggle="dropdown" data-target="#" href="">
                            <div class="input-group">
                                <input type="text-large" class="form-control" value="{{busStartDate|date: 'yyyy-MM-dd'}}" placeholder="乘车日期（开始）">
                                <span class="input-group-addon">
                                    <i class="glyphicon glyphicon-calendar"></i>
                                </span>
                            </div>
                        </a>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="busStartDate">
                            <datetimepicker data-ng-model="busStartDate"
                                            data-datetimepicker-config="{ startView: 'day', minView: 'day', dropdownSelector: '#busStartDate' }"></datetimepicker>
                        </ul>
                    </div>                
			</div>
        </div>
    </div>
</div>
</body>
</html>